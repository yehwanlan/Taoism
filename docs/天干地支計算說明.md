# 🗓️ 天干地支計算說明

## 📚 基本概念

### 天干地支系統
- **天干**: 甲、乙、丙、丁、戊、己、庚、辛、壬、癸 (10個)
- **地支**: 子、丑、寅、卯、辰、巳、午、未、申、酉、戌、亥 (12個)
- **六十甲子**: 天干地支組合，60天為一個循環

### 六十甲子順序
```
甲子、乙丑、丙寅、丁卯、戊辰、己巳、庚午、辛未、壬申、癸酉、
甲戌、乙亥、丙子、丁丑、戊寅、己卯、庚辰、辛巳、壬午、癸未、
甲申、乙酉、丙戌、丁亥、戊子、己丑、庚寅、辛卯、壬辰、癸巳、
甲午、乙未、丙申、丁酉、戊戌、己亥、庚子、辛丑、壬寅、癸卯、
甲辰、乙巳、丙午、丁未、戊申、己酉、庚戌、辛亥、壬子、癸丑、
甲寅、乙卯、丙辰、丁巳、戊午、己未、庚申、辛酉、壬戌、癸亥
```

## 🔢 計算方法

### 1. Julian Day Number (儒略日數)
我們使用儒略日數來進行精確的日期計算：

```javascript
// 計算儒略日數的公式
function getJulianDayNumber(year, month, day) {
    let a = Math.floor((14 - month) / 12);
    let y = year + 4800 - a;
    let m = month + 12 * a - 3;
    
    return day + Math.floor((153 * m + 2) / 5) + 365 * y + 
           Math.floor(y / 4) - Math.floor(y / 100) + 
           Math.floor(y / 400) - 32045;
}
```

### 2. 基準日期
- **基準**: 公元1年1月1日 = 甲子日
- **儒略日數**: 1721426
- 這是傳統曆法學中公認的基準點

### 3. 天干地支計算
```javascript
// 計算步驟
const jdn = getJulianDayNumber(year, month, day);
const daysSinceEpoch = jdn - 1721426;  // 距離基準日的天數
const stemBranchIndex = daysSinceEpoch % 60;  // 六十甲子索引

// 分別計算天干和地支
const stemIndex = stemBranchIndex % 10;   // 天干索引 (0-9)
const branchIndex = stemBranchIndex % 12; // 地支索引 (0-11)
```

## 🎯 驗證方法

### 已知日期驗證
我們使用一些已知的天干地支日期來驗證計算準確性：

1. **2024年2月10日** = 甲子日 (春節)
2. **2024年1月1日** = 癸卯日
3. **2025年1月1日** = 戊申日

### 線上工具對比
可以使用以下工具驗證：
- 中國農曆網站
- 萬年曆工具
- 專業曆法軟體

## 📖 拜拜好日子資料來源

### 資料依據
我們的拜拜好日子資料來自傳統道教典籍中的六十甲子日宜忌記錄：

```
甲子、乙丑日，諸神在地。若人求福，設醮還願，求男乞女，收福十倍。
丙寅日，諸神在天。若人求福還願，祭祀山川，召魂代命，返受其殃。
...
```

### 分類標準
- **大吉 (good)**: 適合拜拜祭祀，收福十倍
- **大凶 (bad)**: 不宜拜拜，可能招致不利
- **謹慎 (neutral)**: 小拜拜可以，大祭祀需謹慎

## 🔍 使用範例

### JavaScript 使用
```javascript
const fortuneChecker = new FortuneChecker();

// 獲取今日資訊
const today = fortuneChecker.getTodayFortune();
console.log(`今日: ${today.stemBranch}日 - ${today.status}`);

// 查詢特定日期
const specificDate = new Date(2025, 0, 15);
const stemBranch = fortuneChecker.getStemBranch(specificDate);
console.log(`2025年1月15日: ${stemBranch}日`);
```

### 網頁顯示
系統會自動在網頁頂部顯示：
- 今日日期和星期
- 天干地支
- 拜拜宜忌狀態
- 詳細說明文字

## ⚠️ 注意事項

### 時區問題
- 計算基於本地時間
- 不同時區可能有一天的差異
- 傳統上以子時(23:00-01:00)為日期分界

### 準確性說明
- 算法基於公曆日期計算
- 與傳統農曆可能有細微差異
- 建議與專業曆書對照確認

### 文化背景
- 此系統基於道教傳統
- 不同宗教可能有不同標準
- 僅供參考，不作為絕對依據

## 🛠️ 技術實現

### 核心算法
1. **日期標準化**: 統一使用公曆日期
2. **儒略日轉換**: 精確計算天數差
3. **模運算**: 計算六十甲子循環位置
4. **索引映射**: 轉換為天干地支字符

### 性能優化
- 預計算常用日期
- 快取計算結果
- 最小化重複計算

### 擴展性
- 支援歷史日期查詢
- 可添加其他曆法系統
- 支援批量日期處理