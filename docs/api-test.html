<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é“æ•™æ—¥å¹²æ”¯ API æ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f7fa;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .api-section {
            background: white;
            margin: 20px 0;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .api-header {
            background: #667eea;
            color: white;
            padding: 15px 20px;
            font-weight: bold;
        }
        
        .api-content {
            padding: 20px;
        }
        
        .api-form {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .api-form input, .api-form select, .api-form button {
            padding: 8px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .api-form button {
            background: #28a745;
            color: white;
            border-color: #28a745;
            cursor: pointer;
        }
        
        .api-form button:hover {
            background: #218838;
        }
        
        .api-result {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .success {
            border-left: 4px solid #28a745;
            background: #d4edda;
        }
        
        .error {
            border-left: 4px solid #dc3545;
            background: #f8d7da;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #667eea;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”Œ é“æ•™æ—¥å¹²æ”¯ API æ¸¬è©¦</h1>
            <p>æ¸¬è©¦å„ç¨® API åŠŸèƒ½å’Œåƒæ•¸</p>
        </div>

        <!-- ä»Šæ—¥è³‡è¨Š API -->
        <div class="api-section">
            <div class="api-header">GET /api/today - ç²å–ä»Šæ—¥è³‡è¨Š</div>
            <div class="api-content">
                <div class="api-form">
                    <select id="today-timezone">
                        <option value="Asia/Taipei">å°åŒ—æ™‚é–“</option>
                        <option value="Asia/Shanghai">åŒ—äº¬æ™‚é–“</option>
                        <option value="Asia/Tokyo">æ±äº¬æ™‚é–“</option>
                        <option value="UTC">UTCæ™‚é–“</option>
                    </select>
                    <label>
                        <input type="checkbox" id="today-traditional" checked> ä½¿ç”¨å‚³çµ±å­æ™‚åˆ†ç•Œ
                    </label>
                    <button onclick="testTodayAPI()">æ¸¬è©¦</button>
                </div>
                <div id="today-result" class="api-result" style="display: none;"></div>
            </div>
        </div>

        <!-- ç‰¹å®šæ—¥æœŸ API -->
        <div class="api-section">
            <div class="api-header">GET /api/date/:date - æŸ¥è©¢ç‰¹å®šæ—¥æœŸ</div>
            <div class="api-content">
                <div class="api-form">
                    <input type="date" id="date-input" value="2024-01-01">
                    <select id="date-timezone">
                        <option value="Asia/Taipei">å°åŒ—æ™‚é–“</option>
                        <option value="Asia/Shanghai">åŒ—äº¬æ™‚é–“</option>
                        <option value="UTC">UTCæ™‚é–“</option>
                    </select>
                    <label>
                        <input type="checkbox" id="date-traditional" checked> ä½¿ç”¨å‚³çµ±å­æ™‚åˆ†ç•Œ
                    </label>
                    <button onclick="testDateAPI()">æ¸¬è©¦</button>
                </div>
                <div id="date-result" class="api-result" style="display: none;"></div>
            </div>
        </div>

        <!-- æœˆä»½æ‰¹é‡æŸ¥è©¢ API -->
        <div class="api-section">
            <div class="api-header">GET /api/month/:year/:month - æ‰¹é‡æŸ¥è©¢æœˆä»½</div>
            <div class="api-content">
                <div class="api-form">
                    <input type="number" id="month-year" value="2024" min="1900" max="2100" placeholder="å¹´ä»½">
                    <input type="number" id="month-month" value="1" min="1" max="12" placeholder="æœˆä»½">
                    <select id="month-timezone">
                        <option value="Asia/Taipei">å°åŒ—æ™‚é–“</option>
                        <option value="UTC">UTCæ™‚é–“</option>
                    </select>
                    <button onclick="testMonthAPI()">æ¸¬è©¦</button>
                </div>
                <div id="month-result" class="api-result" style="display: none;"></div>
            </div>
        </div>

        <!-- å…­åç”²å­è¡¨ API -->
        <div class="api-section">
            <div class="api-header">GET /api/table - å…­åç”²å­å®Œæ•´è¡¨</div>
            <div class="api-content">
                <div class="api-form">
                    <button onclick="testTableAPI()">æ¸¬è©¦</button>
                </div>
                <div id="table-result" class="api-result" style="display: none;"></div>
            </div>
        </div>

        <!-- é©—è­‰ API -->
        <div class="api-section">
            <div class="api-header">GET /api/validation - è¨ˆç®—é©—è­‰</div>
            <div class="api-content">
                <div class="api-form">
                    <button onclick="testValidationAPI()">æ¸¬è©¦</button>
                </div>
                <div id="validation-result" class="api-result" style="display: none;"></div>
            </div>
        </div>

        <!-- å¿«å–ç®¡ç† API -->
        <div class="api-section">
            <div class="api-header">å¿«å–ç®¡ç† API</div>
            <div class="api-content">
                <div class="api-form">
                    <button onclick="testCacheStatusAPI()">æŸ¥çœ‹å¿«å–ç‹€æ…‹</button>
                    <button onclick="testClearCacheAPI()" style="background: #dc3545; border-color: #dc3545;">æ¸…é™¤å¿«å–</button>
                </div>
                <div id="cache-result" class="api-result" style="display: none;"></div>
            </div>
        </div>

        <!-- çµ±è¨ˆè³‡è¨Š -->
        <div class="api-section">
            <div class="api-header">ğŸ“Š ç³»çµ±çµ±è¨ˆ</div>
            <div class="api-content">
                <div class="stats-grid" id="stats-grid">
                    <!-- çµ±è¨ˆå¡ç‰‡å°‡ç”±JavaScriptç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <script src="js/fortune.js"></script>
    <script src="js/fortune-api.js"></script>
    <script>
        // æ¸¬è©¦ä»Šæ—¥ API
        function testTodayAPI() {
            const timezone = document.getElementById('today-timezone').value;
            const useTraditional = document.getElementById('today-traditional').checked;
            
            const result = taoismAPI.getTodayAPI(timezone, useTraditional);
            displayResult('today-result', result);
        }

        // æ¸¬è©¦æ—¥æœŸ API
        function testDateAPI() {
            const date = document.getElementById('date-input').value;
            const timezone = document.getElementById('date-timezone').value;
            const useTraditional = document.getElementById('date-traditional').checked;
            
            if (!date) {
                displayResult('date-result', { success: false, error: 'è«‹é¸æ“‡æ—¥æœŸ' });
                return;
            }
            
            const result = taoismAPI.getDateAPI(date, timezone, useTraditional);
            displayResult('date-result', result);
        }

        // æ¸¬è©¦æœˆä»½ API
        function testMonthAPI() {
            const year = parseInt(document.getElementById('month-year').value);
            const month = parseInt(document.getElementById('month-month').value);
            const timezone = document.getElementById('month-timezone').value;
            
            const result = taoismAPI.getMonthAPI(year, month, timezone);
            displayResult('month-result', result);
        }

        // æ¸¬è©¦è¡¨æ ¼ API
        function testTableAPI() {
            const result = taoismAPI.getStemBranchTableAPI();
            displayResult('table-result', result);
        }

        // æ¸¬è©¦é©—è­‰ API
        function testValidationAPI() {
            const result = taoismAPI.getValidationAPI();
            displayResult('validation-result', result);
        }

        // æ¸¬è©¦å¿«å–ç‹€æ…‹ API
        function testCacheStatusAPI() {
            const result = taoismAPI.getCacheStatus();
            displayResult('cache-result', result);
        }

        // æ¸¬è©¦æ¸…é™¤å¿«å– API
        function testClearCacheAPI() {
            const result = taoismAPI.clearCache();
            displayResult('cache-result', result);
        }

        // é¡¯ç¤ºçµæœ
        function displayResult(elementId, result) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `api-result ${result.success ? 'success' : 'error'}`;
            element.textContent = JSON.stringify(result, null, 2);
        }

        // åˆå§‹åŒ–çµ±è¨ˆè³‡è¨Š
        function initializeStats() {
            const tableResult = taoismAPI.getStemBranchTableAPI();
            const validationResult = taoismAPI.getValidationAPI();
            const cacheResult = taoismAPI.getCacheStatus();
            
            const statsGrid = document.getElementById('stats-grid');
            
            if (tableResult.success) {
                const stats = tableResult.data.statistics;
                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">${stats.good.count}</div>
                        <div class="stat-label">å¤§å‰æ—¥ (${stats.good.percentage}%)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.bad.count}</div>
                        <div class="stat-label">å¤§å‡¶æ—¥ (${stats.bad.percentage}%)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${stats.neutral.count}</div>
                        <div class="stat-label">è¬¹æ…æ—¥ (${stats.neutral.percentage}%)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${validationResult.data.passedTests}</div>
                        <div class="stat-label">é©—è­‰é€šé</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${cacheResult.data.cacheSize}</div>
                        <div class="stat-label">å¿«å–é …ç›®</div>
                    </div>
                `;
            }
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initializeStats();
            
            // è‡ªå‹•æ¸¬è©¦ä»Šæ—¥ API
            testTodayAPI();
        });
    </script>
</body>
</html>